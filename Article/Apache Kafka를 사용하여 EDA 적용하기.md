# Apache Kafka를 사용하여 EDA 적용하기

### EDA 정의

분산된 시스템 간에 사용될 수 있는 아키텍처 

이벤트가 생성되어 발행되면, 이벤트 로그를 보관하며 해당 이벤트를 필요로 하는 구독자가 이벤트를 받아 처리함

 EDA를 적용하고 책임과 역할을 분리, 서비스 간 의존도를 낮춤

이벤트를 적용하면 pub하는 서버는 sub하는 서버가 어떤 서버인지 몰라도 된다. 하지만 발행하는 이벤트의 exchange나 routing하는 정보는 알아야함 (api로 할 경우 api 주소를 알아야함)

### 이벤트가 실패헀을 경우?

- failed 이벤트를 발생시키고 이 전에 보관되어 있던 이벤트 로그 기반으로 롤백을 수행
- 재시도가 필요한 경우, requeue 또는 dead-letter-queue 기능을 사용하여 재시도를 한다

RabbitMQ를 쓰면 좋은 점

- 카프카는 consume 순서가 단일 파티션이 아닐 경우 보장되지 않는다. rabbitmq는 대기열의 개념이기 때문에 된다 (순서가 중요하면 rabbitmq)

### 카프카를 채택하는 이유

- 높은 처리량 및 고성능/분산/스케일 아웃이 중요한 경우
- 가용성이 높아야 하는 경우
- 메시지 영속성이 필요한 경우