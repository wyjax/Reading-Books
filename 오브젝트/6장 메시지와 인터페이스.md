# 6장 메시지와 인터페이스

좋은 인터페이스는 최소한의 인터페이스와 추상적인 인터페이스라는 조건을 만족해야함

- 최소한의 인터페이스? 필요한 정보만 최소한으로 갖는다는 의미?
- 추상적인 인터페이스?

### 디미터 법칙

객체의 내부 구조에 강하게 결합되지 않도록 협력 경로를 제한하는 것

```java
screening.getMovie().getDiscountConditions();
// 디미터의 법칙을 위반하는 코드
screening.calculateFee(audienceCount);
// 디미터의 법칙에 따라 코드를 개선하면 메시지 전송자는 더 이상 메시지 수신자의 내부 구조를 볼 필요가 없음 > 응집도가 높아진다 
```

### 묻지 말고 시켜라

디미터 법칙은 휼륭한 메시지는 객체의 상태에 관해 묻지 말고 원하는 것을 시켜야 한다는 사실을 강조한다. 

객체의 외부에서 해당 객체의 상태에 따라서 결정을 내리는 것은 캡슐화를 위반하는 것. 휼륭한 인터페이스를 위해서 객체의 작업이 어떻게 수행되는지 노출해선 안된다.

### 의도를 드러내는 인터페이스

인터페이스 메서드명 작성법

```java
public class PeriodCondition {
	public boolean isSatisfiedByPeriod();
}
public class SequenceCondition {
	public boolean isSatisfiedBySequence();
}

// byPeriod, BySequence의 메서드명을 통해서 메서드가 내부에서 무엇을 하는지 세세하게 알게 된다 굳이 이런 것은 필요없음

// 2개의 메서드를 고치면,,,
public boolean isSatisfied(); // 적당히 이렇게 하면됨
```

어떻게 내부적으로 동작하는지 알기 볻는 어떤거를 하고 결과를 어떻게 주는지만 알면 된다. isEmpty() 같은 메서드를 예로 들면 empty 체크를 어떻게 하든 메서드명으로 생각하는 기능과 결과가 일치하면 된다

디미터 법칙의 준수는 객체의 내부 구조를 유출하지 않고 캡슐화하면 디미터의 법칙을 준수한 것이다.

### 명령-쿼리 분리 원칙

명령쿼리 분리 원칙은 public interface에 operation을 정의할 때 참고할 수 있는 지침을 제공함

어떤 절차로 호출 가능하도록 하는 기능 모듈은 루틴(routine)이라고 함, 루틴은 프로시저와 함수로 구분함

- 프로시저는 부수 효과를 발생시킬 수 있지만 값을 반환할 수 없다
- 함수는 값을 반환할 수 있지만 부수 효과를 발생시키지 않는다

어떤 오퍼레이션도 명령인 동시에 쿼리여서는 안됨

- 객체의 상태를 변경하는 명령은 반환값을 가질 수 없다
- 객체의 정보를 반환하는 쿼리는 상태를 변경할 수 없다.

명령과 쿼리를 분리해서 얻는 장점

```java
public boolean isSatisfied(schedule) {
	if (조건만족) {
		reschedule(schedule)
		return false;
	}
	return true;
}
// 쿼리 안에 명령이 들어가 있다. 
```

참조 투명성

어떤 표현식 e가 있을 때 e의 값으로 e가 나타내는 모든 위치를 교체하더라도 결과가 달리지지 않는 것을 말함

```java
f() + f() = 6
f() * 2 = 6
// 위와 같을 때 f() = 3으로 치환해서 사용하면
3 + 3 = 6
3 * 2 = 6
	// 으로 치환이 된다 
```